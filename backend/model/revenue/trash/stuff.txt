alrigth great then lets put this into preatice combine all the files and its data into one single calculation that retruns the revenue for the next 20 years, , hereby we wantto have the follwing inputs, the time series for the actual mwh output of our windpark (i will use some mock data here), the predicted market price, the predicted curtailment rate per tso (here we need var 0,1,2,3 that specifies the tso in whicht he wind park is), the predicted capturefactor, adn the predicted eeg (also with a dummy 0/1 on off switch as not all windparks do necessary recieve eeg; also we need to the option to manually enter the eeg auction price if we wnat otherwise the default prediction is being used) also not that the eeg is set one at inception, so if i build the windpark today the eeg aution price is constant for the next 20 years and does not change over time; please write a script that combines all theis dat under the given specification i will now send you the head of each file so you will get the structure rigth: 

market_price_forecast_20y_monthly.csv :

date,price_eur_mwh_forecast,log_price_shifted_forecast,mu_log_shifted
2026-01-01,85.82293405857496,5.655372507407772,5.66293884840441
2026-02-01,81.88877708443124,5.641512585637001,5.664589067345759
2026-03-01,83.80077815150571,5.64827250662319,5.666239286287107
2026-04-01,77.23822645701097,5.624877159889699,5.667889505228455
2026-05-01,76.60409002091137,5.6225872058925255,5.669539724169804
2026-06-01,85.87904956190857,5.6555688177412025,5.671189943111152
2026-07-01,95.93447968588873,5.690138077409461,5.6728401620525
2026-08-01,106.08358181458436,5.723858207840489,5.6744903809938485
2026-09-01,107.91234577409284,5.729815150827132,5.676140599935197
2026-10-01,96.81969300255764,5.693124860178874,5.677790818876545
2026-11-01,108.38447875927386,5.731347312145342,5.6794410378178934
2026-12-01,110.52199497124496,5.738254736131182,5.681091256759242


capture_factor_forecast_b2.csv :


month,cf_hist,wind_mwh_hist,wind_mwh_low,cf_low,wind_mwh_base,cf_base,wind_mwh_high,cf_high
2015-01-01,0.7971657646881044,7830853.25,,,,,,
2015-02-01,0.8690542944179981,5325677.75,,,,,,
2015-03-01,0.8255342879088481,7010958.25,,,,,,
2015-04-01,0.8730305964403778,5157796.5,,,,,,
2015-05-01,0.9108853171899532,5105062.25,,,,,,
2015-06-01,0.9352319647730498,3871212.5,,,,,,
2015-07-01,0.8438483980050792,5401805.25,,,,,,
2015-08-01,0.9394317407515804,3553163.75,,,,,,
2015-09-01,0.8796387097310245,5328808.5,,,,,,

curltailment_forecast_quarterly_by_tso_2021_2046.csv :


quarter,TSO,wind_mwh,load_mwh,S,cr_hat
2021Q1,50Hertz,10332139.598789917,26458894.51705215,0.3904977810819379,0.037591391757116115
2021Q2,50Hertz,6250356.920074381,23348612.198897533,0.2676971490566582,0.033994561506153556
2021Q3,50Hertz,5208241.8405525815,23550796.659246545,0.22114928492271257,0.03263117466462488
2021Q4,50Hertz,9703123.698236724,25964529.24843711,0.3737068985689693,0.03709958684400646
2022Q1,50Hertz,10435460.994777817,26591188.98963741,0.39244055611219636,0.037648295633622306
2022Q2,50Hertz,6312860.489275125,23465355.25989202,0.2690289756688804,0.03403357070479426
2022Q3,50Hertz,5260324.258958107,23668550.64254278,0.222249530121333,0.0326634008441535
2022Q4,50Hertz,9800154.935219092,26094351.894679293,0.37556613687030754,0.03715404392990016
2023Q1,50Hertz,10539815.604725594,26724144.934585594,0.39439299668986894,0.0377054826139917
2023Q2,50Hertz,6375989.094167876,23582682.03619148,0.27036742828414845,0.034072773979050085
2023Q3,50Hertz,5312927.501547689,23786893.39575549,0.22335524917666308,0.032695787352933506
2023Q4,50Hertz,9898156.484571284,26224823.654152684,0.3774346251134435,0.037208771946569456


 eeg_strike_forecast_monthly.csv :


date,market_price,markup_path,eeg_strike_eur_mwh,eeg_strike_used
2017-05-01,,,,58.18198836539946
2017-08-01,,,,46.38126336720261
2017-11-01,,,,40.21597779874906
2018-02-01,,,,49.04926605115101
2018-05-01,,,,54.78163339623266
2018-08-01,,,,61.14684871577759
2018-10-01,,,,61.72408909488863
2019-02-01,,,,60.41094535333106
2019-05-01,,,,61.15970640086792
2019-08-01,,,,61.979268547544415
2019-09-01,,,,61.95088120973324
2019-10-01,,,,61.99803988827363
2019-12-01,,,,61.10253703487694
2020-02-01,,,,61.763773620738775
2020-03-01,,,,60.80221878224975
2020-06-01,,,,61.35732158514938
2020-07-01,,,,60.84980371630464
2020-09-01,,,,61.91446287646964
2020-10-01,,,,61.14088042135379
2020-12-01,,,,59.82482879318216
2021-02-01,,,,59.96789092932666
2021-05-01,,,,58.775423415045765
2021-09-01,,,,58.09116808491973
2022-02-01,,,,57.39408816697126
2022-05-01,,,,58.46440558037364
2022-09-01,,,,58.40856262780524
2022-12-01,,,,58.652745629155376
2023-02-01,,,,73.44257057801043
2023-05-01,,,,73.4212445680079
2023-08-01,,,,73.23959569784614
2023-11-01,,,,73.10216951872873
2024-02-01,,,,73.35302733204787
2024-05-01,,,,73.26267336173912
2024-08-01,,,,73.26267336173912
2024-11-01,,,,71.9
2025-02-01,,,,70.0
2025-05-01,,,,68.7
2025-08-01,,,,66.2
2026-01-01,44.594443155319794,1.146908561635263,51.14574865619333,51.14574865619333
2026-02-01,39.8876563183496,1.1462991523499686,45.72318662695101,45.72318662695101
2026-03-01,40.31309723395208,1.1456926694210385,46.18641998259644,46.18641998259644
2026-04-01,33.71001488980778,1.1450890987962388,38.60097057057778,38.60097057057778
2026-05-01,32.24481358096807,1.1444884264908146,36.9038159577718,36.9038159577718
2026-06-01,39.17433840003221,1.1438906385871643,44.81115896864252,44.81115896864252
2026-07-01,46.79436025343941,1.1432957212345192,53.49979185566392,53.49979185566392
2026-08-01,54.5263014655435,1.14270366064862,62.30740428630677,62.30740428630677
2026-09-01,55.389489699997256,1.1421144431113999,63.26113618293699,63.26113618293699
2026-10-01,45.62275007189419,1.141528054970665,52.07964915198214,52.07964915198214
2026-11-01,54.667081420068826,1.140944482639779,62.3721049282471,62.3721049282471
2026-12-01,55.9591260499198,1.1403637125973476,63.81375673598949,63.81375673598949
2027-01-01,47.77805957013297,1.1397857313869062,54.456750571391176,54.456750571391176
2027-02-01,42.94185981096632,1.1392105256166072,48.9198186862056,48.9198186862056
2027-03-01,43.3108854302921,1.13863808195891,49.3154235142899,49.3154235142899
2027-04-01,36.57096983074101,1.1380683871502724,41.62026465179269,41.62026465179269

